<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Home - WatchIt</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../resources/homepage.css">
    <link rel="stylesheet" href="../resources/forms.css">
    <link rel="stylesheet" href="../resources/footer.css">
    <link rel="stylesheet" href="../resources/navbar.css">
    <link rel="stylesheet" href="../resources/generalstyles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
</head>

<!-- Overriding bootstrap css which causes spacing issues with only this form -->
<style>
    .form-group {
        margin-bottom: 0px;
    }
</style>

<body>
    <!-- The entire code is wrapped so it fits the whole page even on big screens, preventing whitespace -->
    <div class="formwrapper" style="background-image: url('../resources/images/contactus.jpg')">
        <div>
            <!-- The navbar with toggle button for mobile devices -->
            <nav class="navbar navbar-dark navbar-expand-lg navbarposition" style="background-color:rgba(8, 33, 49,1)">
                <div class="container">
                    <a class="navbar-brand title-text" style="font-size: 40px">WatchIt</a><button data-toggle="collapse"
                        class="navbar-toggler" data-target="#navigation">
                        <span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link ftext" href="../index.html">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link ftext" href="features.html">Featured</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active ftext" href="contact-us.html">Contact Us</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link ftext" href="login.html">Login</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link ftext" href="subscribe.html">Subscribe</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <!-- Navbar seperator -->
            <div style="background-color:rgb(50, 56, 94); line-height: 50%;">
                <br>
            </div>
            <!-- The contact us form, including errors that only appear on an invalid input -->
            <main class="page">
                <section class="formstyle dark">
                    <div class="container">
                        <div>
                            <div class="heading white">
                                <b>
                                    <h2 class="text-white display-4 title-text">Contact Us</h2>
                                </b>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col" style="padding: 0">
                                <form id="contactForm">
                                    <div class="alert alert-success alert-dismissible fade show" id="successful"
                                        role="alert" style="display: none;">
                                        Your query has been sent, along with your contact details, to our support team.
                                        <button type="button" class="close"
                                            onclick="this.parentNode.style.display = 'none'" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <!-- The name input and hidden error -->
                                    <div class="form-group">
                                        <label class="ftext">Name</label><input class="form-control" type="text"
                                            id="contactname">
                                        <span class="formerrormessage" id="nameerror">Please enter a name</span>
                                    </div>
                                    <!-- The email input and hidden error -->
                                    <div class="form-group">
                                        <label class="ftext" l>Email</label><input class="form-control" type="text"
                                            placeholder="example@mail.uk" id="contactemail">
                                        <span class="formerrormessage" id="emailerror">Expected format:
                                            example@mail.com</span>
                                    </div>
                                    <!-- The contact reason option and hidden error -->
                                    <div class="form-group">
                                        <label class="ftext" l>Topic</label>
                                        <select class="form-control" id="contacttopic">
                                            <option selected disabled hidden>Please choose a topic</option>
                                            <option>Password Reset</option>
                                            <option>Show Suggestion</option>
                                            <option>Payment Issue</option>
                                            <option>General Inquiry</option>
                                        </select>
                                        <span class="formerrormessage" id="topicerror">Please choose a non-placeholder
                                            topic</span>
                                    </div>
                                    <!-- The query input and hidden error -->
                                    <div class="form-group">
                                        <label class="ftext">What would you like to tell us?</label>
                                        <textarea class="form-control" maxlength="500" id="contacttext"></textarea>
                                        <span class="formerrormessage" id="texterror">Please send us a full
                                            message</span>
                                    </div>
                                    <!-- Data disclaimer message -->
                                    <label class="ftext text-center w-100">We do not use this data outside of your
                                        query.</label>
                                    <!-- The submission button, which checks for errors and returns alert on success -->
                                    <div class="form-group">
                                        <button class="btn btn-primary btn-block" onclick="handleContact()"
                                            type="submit" id="contactbutton">
                                            Send
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                </section>
            </main>
        </div>
        <div>
            <!-- The footer seperator  -->
            <div style="background-color:rgb(50, 56, 94); line-height: 50%;">
                <br>
            </div>
            <!-- The page footer  -->
            <footer class="page-footer">
                <div class="container">
                    <div class="row">
                        <div class="col-sm">
                            <img class="rounded-circle" src="../resources/images/play.png" alt="" width="50%">
                        </div>
                        <div class="col-sm">
                            <h5>Get started</h5>
                            <ul>
                                <!-- N.B. The footer-item class is a test class and has no associated css -->
                                <li class="footer-item"><a href="../index.html">Home</a></li>
                                <li class="footer-item"><a href="subscribe.html">Sign up</a></li>
                            </ul>
                        </div>
                        <div class="col-sm">
                            <h5>About us</h5>
                            <ul>
                                <li class="footer-item"><a href="contact-us.html">Contact us</a></li>
                            </ul>
                        </div>
                        <div class="col-sm">
                            <h5>Support</h5>
                            <ul>
                                <li class="footer-item"><a href="../index.html#faqs">FAQs</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-copyright">
                    <p>WatchIt Â© 2021 Copyright</p>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.bundle.min.js"></script>
    <script>
        /**
         * Handles the errors of the contact-us form
         */
        function handleContact() {
            //Getting the form element inputs as constants for the error handling
            const name = document.getElementById("contactname").value
            const email = document.getElementById("contactemail").value
            const topic = document.getElementById("contacttopic").value
            const text = document.getElementById("contacttext").value

            let valid = true //Variable used in expecting the alert on success case

            //All these if statements control if the respective error should display or not, and valid will be set to false if any error triggers
            if (validName(name)) {
                document.getElementById("nameerror").style.visibility = "hidden"
            } else {
                valid = false
                document.getElementById("nameerror").style.visibility = "visible"
            }

            if (validEmail(email)) {
                document.getElementById("emailerror").style.visibility = "hidden"
            } else {
                valid = false
                document.getElementById("emailerror").style.visibility = "visible"
            }

            if (validTopic(topic)) {
                document.getElementById("topicerror").style.visibility = "hidden"
            } else {
                valid = false
                document.getElementById("topicerror").style.visibility = "visible"
            }

            if (validText(text)) {
                document.getElementById("texterror").style.visibility = "hidden"
            } else {
                valid = false
                document.getElementById("texterror").style.visibility = "visible"
            }

            //Using the let valid line above to check for an error if success case is not triggered
            if (valid) {
                document.getElementById("successful").style.display = "block"
            }
        }

        /**
         * Returns true if a name has been entered
         * @param name: the name entered
         */
        function validName(name) {
            return /\S/.test(name)
        }

        /**
         * Returns true if the email matches the regex for emails: (string + '@' + string + '.' + string)
         * @param email: the email entered
         */
        function validEmail(email) {
            return /\S+@\S+\.\S+/.test(email)
        }

        /**
         * Returns true if a topic has been selected other than the default topic
         * @param topic: the topic selected
         */
        function validTopic(topic) {
            return topic && topic !== "Please choose a topic"
        }

        /**
         * Returns true if there is a message over 10 characters
         * @text: the query text entered
         */
        function validText(text) {
            return text.length >= 10 && /\S/.test(text)
        }

        //Preventing refresh by default, which prevents the alert
        document.getElementById("contactForm").addEventListener("submit", (event) => {
            event.preventDefault()
        })
    </script>
</body>

</html>